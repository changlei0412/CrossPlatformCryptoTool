<!-- Views/MainWindow.axaml -->
<Window xmlns="https://github.com/avaloniaui"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
 xmlns:vm="using:CrossPlatformCryptoTool.ViewModels"
 xmlns:models="using:CrossPlatformCryptoTool.Models"
 x:Class="CrossPlatformCryptoTool.Views.MainWindow"
 x:DataType="vm:MainWindowViewModel"
 Title="跨平台加密工具 - Cross Platform Crypto Tool"
 Width="1000" Height="700"
 MinWidth="800" MinHeight="500"
 WindowStartupLocation="CenterScreen">

	<Design.DataContext>
		<vm:MainWindowViewModel />
	</Design.DataContext>

	<Window.Styles>
		<Style Selector="TextBlock.card-header">
			<Setter Property="FontSize" Value="18" />
			<Setter Property="FontWeight" Value="SemiBold" />
			<Setter Property="Margin" Value="0,0,0,8" />
		</Style>

		<Style Selector="Button.primary">
			<Setter Property="Background" Value="#0078D4" />
			<Setter Property="Foreground" Value="White" />
			<Setter Property="Padding" Value="12,8" />
			<Setter Property="CornerRadius" Value="6" />
			<Setter Property="FontWeight" Value="SemiBold" />
		</Style>

		<Style Selector="Button.ghost">
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="BorderBrush" Value="#0078D4" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="Foreground" Value="#0078D4" />
			<Setter Property="Padding" Value="10,6" />
			<Setter Property="CornerRadius" Value="6" />
		</Style>

		<Style Selector="Border.card">
			<!-- Use transparent so theme backgrounds show through -->
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="Padding" Value="16" />
			<Setter Property="CornerRadius" Value="8" />
			<Setter Property="Margin" Value="0,0,0,12" />
			<Setter Property="BorderBrush" Value="#FFE6EAF2" />
			<Setter Property="BorderThickness" Value="1" />
		</Style>
	</Window.Styles>

	<!-- Remove hard-coded grid background so theme controls appearance -->
	<Grid Margin="18">
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="320" />
			<ColumnDefinition Width="*" />
		</Grid.ColumnDefinitions>

		<!-- Left column: settings and actions -->
		<ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
			<StackPanel>
				<Border Classes="card">
					<StackPanel>
						<TextBlock Text="算法与参数" Classes="card-header" />

						<StackPanel Spacing="8">
							<TextBlock Text="加密算法" />
							<ComboBox ItemsSource="{Binding Algorithms}" SelectedItem="{Binding SelectedAlgorithm}" />

							<TextBlock Text="密钥长度" IsVisible="{Binding IsNotHashingAlgorithm}" />
							<ComboBox ItemsSource="{Binding KeySizes}" SelectedItem="{Binding SelectedKeySize}" IsVisible="{Binding IsNotHashingAlgorithm}" />

							<TextBlock Text="模式" IsVisible="{Binding IsNotHashingAlgorithm}" />
							<ComboBox ItemsSource="{Binding Modes}" SelectedItem="{Binding SelectedMode}" IsVisible="{Binding IsNotHashingAlgorithm}" />

							<StackPanel Orientation="Horizontal" VerticalAlignment="Center" Spacing="8" Margin="0,6,0,0">
								<CheckBox Content="Base64 输出" IsChecked="{Binding OutputBase64}" IsVisible="{Binding IsNotHashingAlgorithm}" />
							</StackPanel>
						</StackPanel>
					</StackPanel>
				</Border>

				<Border Classes="card">
					<StackPanel>
						<TextBlock Text="密钥与向量" Classes="card-header" />
						<StackPanel Spacing="8">
							<TextBlock Text="密钥 (Key)" />
							<TextBox Text="{Binding Key}" Watermark="输入密钥或留空自动生成" />
							<Button Content="生成随机密钥" Command="{Binding GenerateRandomKeyCommand}" Classes="ghost" />

							<TextBlock Text="向量 (IV)" Margin="0,8,0,0" />
							<TextBox Text="{Binding IV}" Watermark="输入向量或留空自动生成" />
							<Button Content="生成随机IV" Command="{Binding GenerateRandomIVCommand}" Classes="ghost" />
						</StackPanel>
					</StackPanel>
				</Border>

				<Border Classes="card">
					<StackPanel>
						<TextBlock Text="操作" Classes="card-header" />
						<StackPanel Orientation="Vertical" Spacing="8">
							<Button Content="🔒 加密" Command="{Binding EncryptCommand}" Classes="primary" />
							<Button Content="🗝️ 解密" Command="{Binding DecryptCommand}" Classes="primary" />
							<StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Stretch">
								<Button Content="🔁交换文本" Command="{Binding SwapTextCommand}" Classes="ghost" HorizontalAlignment="Stretch" />
								<Button Content="🧹 清除" Command="{Binding ClearCommand}" Classes="ghost" HorizontalAlignment="Stretch" />
							</StackPanel>
						</StackPanel>
					</StackPanel>
				</Border>

				<Border Classes="card">
					<StackPanel>
						<TextBlock Text="说明" Classes="card-header" />
						<TextBlock TextWrapping="Wrap" Foreground="#666">
							• AES/SM4: 对称加密算法，需要密钥和IV。{LineBreak}
							• SHA256/SHA512/SM3: 哈希算法，不可逆。{LineBreak}
							• 密钥和IV留空时将自动生成（SM4 有默认值）。{LineBreak}
							• 支持 Windows、macOS、Linux 平台。
						</TextBlock>
					</StackPanel>
				</Border>
			</StackPanel>
		</ScrollViewer>

		<!-- Right column: input and output panels -->
		<StackPanel Grid.Column="1" Margin="18,0,0,0">
			<Border Classes="card">
				<StackPanel>
					<TextBlock Text="输入（明文或密文）" Classes="card-header" />
					<TextBox Text="{Binding InputText}" AcceptsReturn="True" TextWrapping="Wrap" Height="220" FontSize="14" />
				</StackPanel>
			</Border>

			<Border Classes="card">
				<StackPanel>
					<TextBlock Text="输出" Classes="card-header" />
					<TextBox Text="{Binding OutputText}" AcceptsReturn="True" TextWrapping="Wrap" Height="200" FontSize="14" IsReadOnly="True" />

					<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0" Spacing="8">
						<Button Content="📋复制输出" Command="{Binding CopyOutputCommand}" Classes="ghost" />
						<Button Content="💾 保存到文件" Command="{Binding SaveOutputCommand}" Classes="ghost" />
						<Button Content="🌓 切换主题" Command="{Binding ToggleThemeCommand}" Classes="ghost" />
					</StackPanel>
				</StackPanel>
			</Border>

			<!-- Status at bottom (prominent) -->
			<TextBlock Text="{Binding StatusMessage}" Foreground="{Binding StatusBrush}" FontWeight="{Binding StatusFontWeight}" Margin="4" />
		</StackPanel>
	</Grid>
</Window>